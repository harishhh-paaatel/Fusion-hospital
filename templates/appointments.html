{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h4 style="color:var(--brand)">Appointments</h4>
  <a class="btn btn-sm btn-brand" href="{{ url_for('booking') }}"><i class="bi bi-plus-lg"></i> New Booking</a>
</div>

<div class="row g-3">
  {% for a in appointments %}
  <div class="col-md-4">
    <div class="card-pro">
      <div class="d-flex justify-content-between">
        <div>
          <div style="font-weight:700">{{ patients.get(a[1], 'Patient #' + (a[1]|string)) }}</div>
          <div class="muted small">{{ doctors.get(a[2], 'Doctor #' + (a[2]|string)) }}</div>
        </div>
        <div class="text-end">
          <div class="muted small">{{ a[4] }}</div>
          <div style="font-weight:700">{{ a[5] }}</div>
        </div>
      </div>

      <div class="d-flex justify-content-between align-items-center mt-3">
        <div>
          {% if a[6]=='CONFIRMED' %}
            <span class="badge bg-success">CONFIRMED</span>
          {% elif a[6]=='PENDING' %}
            <span class="badge bg-warning text-dark">PENDING</span>
          {% else %}
            <span class="badge bg-secondary">CANCELLED</span>
          {% endif %}
        </div>
        <div>
          <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('edit_appointment', appt_id=a[0]) }}"><i class="bi bi-pencil"></i></a>
          <form method="post" action="{{ url_for('delete_appointment', appt_id=a[0]) }}" style="display:inline" onsubmit="return confirm('Delete appointment?');">
            <button class="btn btn-sm btn-danger"><i class="bi bi-trash"></i></button>
          </form>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}
